{% macro label(person, context=None) %}
    {%- if context != person -%}
        <a href="{{ person | url }}">
    {%- endif -%}
    {%- if person.private -%}
        <span class="private" title="This person's details are unavailable to protect their privacy.">private</span>
    {%- else -%}
        {{ nameLabel(person.name) }}
    {%- endif -%}
    {%- if context != person -%}
        </a>
    {%- endif -%}
{% endmacro %}

{%- macro nameLabel(name) -%}
    <span class="person-label" typeof="foaf:Person">
    {% if name.individual -%}
        <span property="foaf:individualName">{{ name.individual.name }}</span>
    {%- else -%}
        …
    {%- endif -%}
    {%- if name.family %}
        <span property="foaf:familyName">{{ name.family }}</span>
    {%- endif -%}
    </span>
{%- endmacro -%}

{% macro sortableLabel(person, link=True) %}
    {%- if link -%}
        <a href="{{ person | url }}">
    {%- endif -%}
    {%- if person.private -%}
        <span class="private" title="This person's details are unavailable to protect their privacy.">private</span>
    {%- else -%}
        <span class="person-label" typeof="foaf:Person">
        {%- if person.name.family -%}
            <span property="foaf:familyName">{{ person.name.family }}</span>
        {%- else -%}
            …
        {%- endif -%}
        , {% if person.name.individual -%}
            <span property="foaf:individualName">{{ person.name.individual.name }}</span>
        {%- else -%}
            …
        {%- endif -%}
        </span>
    {%- endif -%}
    {%- if link -%}
        </a>
    {%- endif -%}
{% endmacro %}
