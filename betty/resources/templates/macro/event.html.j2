{% macro label(event, person_context=None) %}
    <a href="/event/{{ event.id }}">{{ type_label(event) }}</a>
    {% set people = event.people | reject('equalto', person_context) | list %}
    {% if people | length > 0 %}
        {% if person_context %}with{% else %}of{% endif %}
        {% set ns = namespace(people_labels=[]) %}
        {% for person in people | sort(attribute='name') %}
            {% set ns.people_labels = ns.people_labels + ['<a href="/person/' + person.id + '">' + person.name + '</a>'] %}
        {% endfor %}
        {{ ns.people_labels | join(' and ') }}
    {% endif %}
{% endmacro %}

{% macro type_label(event) %}
    {% set _type_labels = {
        event.Type.BIRTH: 'Birth',
        event.Type.DEATH: 'Death',
        event.Type.BURIAL: 'Burial',
        event.Type.MARRIAGE: 'Marriage',
    } %}
    {{ _type_labels[event.type] }}
{% endmacro %}
