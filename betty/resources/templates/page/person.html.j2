{% extends 'page/base.html.j2' %}
{% import 'macro/person.html.j2' as personMacros %}
{% set title = personMacros.label(person, False) %}
{% block content %}
    {% include 'person-meta.html.j2' %}

    {% set places = person.events | map(attribute='place') | reject('equalto', None) | unique | list %}
    {% if places | length > 0 %}
        {% with places=places %}
            {% include 'list-place.html.j2' %}
        {% endwith %}
    {% endif %}

    <div class="tree"></div>

    {% if person.parents | length > 0 %}
        <h2>Parents</h2>
        <ul>
            {% for parent in person.parents %}
                <li typeof="foaf:Person" property="rel:childOf">{{ personMacros.label(parent) }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if person.children | length > 0 %}
        <h2>Children</h2>
        <ul>
            {% for child in person.children %}
                <li typeof="foaf:Person" property="rel:parentOf">{{ personMacros.label(child) }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if person.siblings | length > 0 %}
        <h2>Siblings</h2>
        <ul>
            {% for sibling in person.siblings %}
                <li typeof="foaf:Person" property="rel:siblingOf">{{ personMacros.label(sibling) }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if person.events | rejectattr('date', 'none') | selectattr('date.complete') | list | length > 0 %}
        <h2>Events</h2>
        {% with events=person.events, person_context=person %}
            {% include 'list-event.html.j2' %}
        {% endwith %}
    {% endif %}

    {% set documents = person.documents | list + person.events | map(attribute="documents") | flatten | unique | list %}
    {% if documents | length > 0 %}
        {% for document in documents %}
            {% include 'document.html.j2' %}
        {% endfor %}
    {% endif %}
{% endblock %}